<ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" size = "medium" color = "#fff" type = "ball-beat" [fullScreen] = "true"><p style="color: white" > Loading... </p></ngx-spinner>
<p-toast></p-toast>
<p-confirmDialog [style]="{width: '50vw'}"></p-confirmDialog> 

<p-card header="Formula">
	<p-table [value]="formulaList"
		#dt1
		[paginator]="true"
		[rows]="5"
		[showCurrentPageReport]="true"
		currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    	[rowsPerPageOptions]="[5, 10, 20]"
		[globalFilterFields]="['brand', 'model', 'shade', 'variant', 'code']"
	>
		<ng-template pTemplate="caption">
			<div class="flex">
				<button pButton label="Clear" class="p-button-outlined" icon="pi pi-filter-slash" (click)="clear(dt1)"></button>
				<span class="p-input-icon-left ml-auto">
					<i class="pi pi-search"></i>
					<input pInputText type="text" (input)="dt1.filterGlobal($event.target.value, 'contains')" 
						placeholder="Search keyword" id="search-formula" 
					/>
				</span>
			</div>
		</ng-template>
		<ng-template pTemplate="header">
			<tr>
				<th>
					Brand
					<p-columnFilter type="text" field="brand" display="menu"></p-columnFilter>
				</th>
				<th>
					Model
					<p-columnFilter type="text" field="model" display="menu"></p-columnFilter>
				</th>
				<th>
					Shade
					<p-columnFilter type="text" field="shade" display="menu"></p-columnFilter>
				</th>
				<th>
					Variant
					<p-columnFilter type="text" field="variant" display="menu"></p-columnFilter>
				</th>
				<th>
					Code
					<p-columnFilter type="text" field="code" display="menu"></p-columnFilter>
				</th>
				<th>
					Action
				</th>
			</tr>
		</ng-template>
		<ng-template pTemplate="body" let-formula>
			<tr>
				<td>{{ formula.brand }}</td>
				<td>{{ formula.model }}</td>
				<td>{{ formula.shade }}</td>
				<td>{{ formula.variant }}</td>
				<td>{{ formula.code}}</td>
				<td>
					<div class="flex gap-3">
						<p-button label="View" (onClick)="view(formula)"></p-button>
					</div>
					
				</td>
			</tr>
		</ng-template>
	</p-table>
</p-card>

<p-dialog header="Formula" [(visible)]="formulaVisible" [style]="{width: '50vw'}">
	<div class="flex justify-content-center tile">
		<div style="width: 300px;">
			<div class="flex row justify-content-between">
				<span>Brand</span>
				<b>{{codeHeader.brand}}</b>
			</div>
			<div class="flex row justify-content-between">
				<span>Model</span>
				<b>{{codeHeader.model}}</b>
			</div>
			<div class="flex row justify-content-between">
				<span>Shade</span>
				<b>{{codeHeader.shade}}</b>
			</div>
			<div class="flex row justify-content-between">
				<span>Variant</span>
				<b>{{codeHeader.variant}}</b>
			</div>
			<div class="flex row justify-content-between">
				<span>Code</span>
				<b>{{codeHeader.code}}</b>
			</div>
		</div>
		
	</div>
	<div class="mt-4 text-center">
		<label  class="mr-2"><b>Enter quantity in ml: </b></label>
		<p-inputNumber inputId="withoutgrouping" [useGrouping]="false" [(ngModel)]="qty" (onInput)="change()"
		styleClass="input-styling"></p-inputNumber>
	</div>
	<div class="flex row justify-content-center gap-4 mt-4">
		<p-table [value]="codeBody">
			<ng-template pTemplate="header">
				<tr>
					<th>Ingredients</th>
					<th>Weight</th>
					<th>Price</th>
				</tr>
			</ng-template>
			<ng-template pTemplate="body" let-formula>
				<tr>
					<td>{{formula.ingredients}}</td>
					<td>{{formula.weight}}</td>
					<td>{{formula.price}}</td>
				</tr>
			</ng-template>
		</p-table>

		<p-table [value]="codeBodyml">
			<ng-template pTemplate="header">
				<tr>
					<th>Ingredients</th>
					<th>Weight</th>
					<th>Price</th>
				</tr>
			</ng-template>
			<ng-template pTemplate="body" let-formula>
				<tr>
					<td>{{formula.ingredients}}</td>
					<td>{{formula.weight}}</td>
					<td>{{formula.price}}</td>
				</tr>
			</ng-template>
		</p-table>
		
	</div>

</p-dialog>