<p-toast></p-toast>
<p-confirmDialog [style]="{width: '50vw'}"></p-confirmDialog>
<p-card header = "Tax Invoice History">
    <div class="flex mb-4">
        <div class="flex gap-3">
            <button pButton label="Clear" pRipple class="p-button-outlined" icon="pi pi-filter-slash" (click)="clear(dt1)"></button>
            <button pButton label="Download" pRipple class="p-button-outlined" icon="pi pi-file-excel" (click)="exportExcel(dt1)" pTooltip="XLSX" tooltipPosition="bottom"></button>
        </div>
        <span class="p-input-icon-left ml-auto">
            <i class="pi pi-search"></i>
            <input pInputText type="text" (input)="dt1.filterGlobal($event.target.value, 'contains')" placeholder="Search keyword" />
        </span>
    </div>
    
    <p-table #dt1 [value]="invoiceDetails" [tableStyle]="{ 'min-width': '50rem' }"
        [paginator]="true"
        [rows]="10"
        [loading]="loading"
        [showCurrentPageReport]="true"
        [rowsPerPageOptions]="[10, 25, 50]"
        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
        [globalFilterFields]="['tnbillno', 'tntime', 'tnname','tnpgst','tntotal','tngdtl']"
        >
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th>
                    <div class="flex align-items-center">
                    Invoice
                    <p-columnFilter type="text" field="tnbillno" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th>
                    <div class="flex align-items-center">
                    Invoice Date
                    <p-columnFilter type="date" field="tntime" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th>
                    <div class="flex align-items-center">
                    Company Name
                    <p-columnFilter type="text" field="tnname" display="menu"></p-columnFilter>
                    </div>
                </th>
				<th>
                    <div class="flex align-items-center">
                    Company GST
                    <p-columnFilter type="text" field="tnpgst" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th>
                    <div class="flex align-items-center">
                    Total Amount
                    <p-columnFilter type="numeric" field="tntotal" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th>
                    <div class="flex align-items-center">
                    Grand Total
                    <p-columnFilter type="numeric" field="tngdtl" display="menu"></p-columnFilter>
                    </div>
                </th>
                <th>Action</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData>
            <tr>
                <td>{{rowData.tnbillno}}</td>
                <td>{{rowData.tntime | date: 'yyyy-MM-dd'}}</td>
                <td>{{rowData.tnname}}</td>
                <td>{{rowData.tnpgst}}</td>
                <td class="text-right">{{rowData.tntotal | number : '1.2-2'}}</td>
                <td class="text-right">{{rowData.tngdtl | number : '1.2-2'}}</td>
                <td>
                    <div class="flex gap-3">
                        <a [routerLink]="['/home/view-invoice/' + rowData.tnbillno]">
                            <i class="pi pi-eye" style="font-size: 1.5rem;cursor: pointer;" pTooltip="View" 
                                tooltipPosition="bottom">
                            </i>
                        </a>

                        <i class="pi pi-download" style="font-size: 1.5rem;cursor: pointer;" pTooltip="Download" 
                            tooltipPosition="bottom" (click)="download(rowData)"></i>

                        <i class="pi pi-trash" style="font-size: 1.5rem;cursor: pointer;" pTooltip="Delete" 
                            tooltipPosition="bottom" (click)="delete(rowData)"></i>
                    </div>
                </td>
        </ng-template>
        <ng-template pTemplate="paginatorleft">
            <i class="pi pi-filter-slash" style="font-size: 1.5rem;cursor: pointer;" pTooltip="Clear Filter" 
            tooltipPosition="bottom" (click)="clear(dt1)"></i>
        </ng-template>
        <ng-template pTemplate="paginatorright">
            <i class="pi pi-file-excel" style="font-size: 2rem;cursor: pointer;" pTooltip="XLSX" 
            tooltipPosition="bottom" (click)="exportExcel(dt1)"></i>
        </ng-template>
        <ng-template pTemplate="emptymessage" let-columns>
            <tr>
              <td colspan="5">No records found</td>
            </tr>
          </ng-template>
    </p-table>
</p-card>