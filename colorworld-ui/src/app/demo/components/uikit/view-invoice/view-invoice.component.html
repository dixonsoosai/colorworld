<p-card>
	<h4>View Tax Invoice</h4>
    <div class="mt-4">
        <div>
            <div class="grid">
                <div class="col">
                    <div class="field grid">
                        <label htmlFor="customerName" class="col-12 mb-2 md:col-3 md:mb-0 font-bold">Customer
                            Name</label>
                        <div class="col-12 md:col-9">
                            <input pInputText type="text" [(ngModel)]="customerDetails.jpname" />
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="field grid">
                        <label htmlFor="gst" class="col-12 mb-2 md:col-3 md:mb-0 font-bold">GST</label>
                        <div class="col-12 md:col-9">
                            <input pInputText type="text" [(ngModel)]="customerDetails.jppgst" />
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="field grid">
                        <label htmlFor="mobile" class="col-12 mb-2 md:col-3 md:mb-0 font-bold">Mobile</label>
                        <div class="col-12 md:col-9">
                            <input pInputText type="number" [(ngModel)]="customerDetails.jpmobno">
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="field grid">
                        <label htmlFor="balance" class="col-12 mb-2 md:col-3 md:mb-0 font-bold">Balance</label>
                        <div class="col-12 md:col-9">
                            <input pInputText type="number" [(ngModel)]="customerDetails.jpbaln">
                        </div>
                    </div>
                </div>
            </div>
			<div class="grid">
				<div class="col-8">
					<div class="field grid">
						<label htmlFor="address" class="col-12 mb-2 md:col-1 md:mb-0 font-bold">Address</label>
						<div class="col-12 md:col">
							<textarea rows="2" pInputTextarea [autoResize]="true" style="width: 100%;"
								[(ngModel)]="customerDetails.jpadd"></textarea>
						</div>
					</div>
				</div>
				<div class="col">
					<div class="field grid">
						<label htmlFor="balance" class="col-12 mb-2 md:col-3 md:mb-0 font-bold">Overflow Limit</label>
						<div class="col-12 md:col-9">
							<input pInputText type="number" [(ngModel)]="overflowLimit">
						</div>
					</div>
				</div>
			</div>
        </div>
    </div>

    <div class="mt-4">
        <p-fieldset legend="Tax Invoice">
            <div class="flex justify-content-between">
                <div class="field grid">
                    <label htmlFor="customerName" class="col-12 mb-2 md:col-5 md:mb-0 font-bold">Invoice
                        Number</label>
                    <div class="col-12 md:col-7">
                        <input pInputText type="text" [(ngModel)]="invoiceNumber" />
                    </div>
                </div>
                <div class="field grid">
                    <div class="flex gap-2">
                        <label htmlFor="customerName" class="col-12 mb-2 md:col-4 md:mb-0 font-bold">Invoice
                            Date</label>
                            <p-calendar dateFormat="yy-mm-dd"  [appendTo]="'body'" [showButtonBar]="true" 
                                [(ngModel)]="invoiceDate"></p-calendar>
                    </div>
                </div>
            </div>
            <p-table [value]="selectedProducts" dataKey="pnpdcd" editMode="row"
					[tableStyle]="{ 'min-width': '50rem' }" [rows]="10" [showCurrentPageReport]="false"
					[rowsPerPageOptions]="[10, 25, 50]" [paginator]="true"
					currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries">
					<ng-template pTemplate="header">
						<tr>
							<th style="width:10%"></th>
							<th style="width:10%">Challan</th>
							<th style="width:25%">Product</th>
							<th style="width:15%">HSNC</th>
							<th style="width:10%">Total Qty</th>
							<th style="width:10%">Unit Qty</th>
							<th style="width:10%">Unit</th>
							<th style="width:10%">Unit Price</th>
							<th style="width:10%">Net Amount</th>
							<th style="width:10%">CGST (%)</th>
							<th style="width:10%">CGST</th>
							<th style="width:10%">SGST (%)</th>
							<th style="width:10%">SGST</th>
							<th style="width:10%">Total Amount</th>
						</tr>
					</ng-template>
					<ng-template pTemplate="emptymessage" let-columns>
						<tr>
							<td [attr.colspan]="14" class="text-center">
								No records found
							</td>
						</tr>
					</ng-template>
					<ng-template pTemplate="body" let-cproduct let-editing="editing" let-index="rowIndex">
						<tr [pEditableRow]="cproduct" [pReorderableRow]="index">
							<td><span class="pi pi-bars" pReorderableRowHandle></span></td>
							<td [pEditableColumn]="cproduct.tnchallan" pEditableColumnField="tnchallan">
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="text" [(ngModel)]="cproduct.tnchallan">
									</ng-template>
									<ng-template pTemplate="output">
										{{cproduct.tnchallan}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td [pEditableColumn]="cproduct.tnscnnm" pEditableColumnField="tnscnnm">
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="text" [(ngModel)]="cproduct.tnscnnm">
									</ng-template>
									<ng-template pTemplate="output">
										{{cproduct.tnscnnm}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td [pEditableColumn]="cproduct.tnhsnc" pEditableColumnField="tnhsnc">
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="text" [(ngModel)]="cproduct.tnhsnc">
									</ng-template>
									<ng-template pTemplate="output">
										{{cproduct.tnhsnc}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td [pEditableColumn]="cproduct.tntqty" pEditableColumnField="tntqty">
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="number" [(ngModel)]="cproduct.tntqty"
											(ngModelChange)="onChange($event, cproduct, 'pnprice')">
										
									</ng-template>
									<ng-template pTemplate="output">
										{{cproduct.tntqty}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td [pEditableColumn]="cproduct.tnuqty" pEditableColumnField="tnuqty">
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="number" [(ngModel)]="cproduct.tnuqty">
									</ng-template>
									<ng-template pTemplate="output">
										{{cproduct.tnuqty}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td [pEditableColumn]="cproduct.tnunit" pEditableColumnField="tnunit">
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="text" [(ngModel)]="cproduct.tnunit">
									</ng-template>
									<ng-template pTemplate="output">
										{{cproduct.tnunit}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td class="text-right" [pEditableColumn]="cproduct.tnprice" pEditableColumnField="tnprice">
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="number" [(ngModel)]="cproduct.tnprice"
											(ngModelChange)="onChange($event, cproduct, 'tnprice')">
										
									</ng-template>
									<ng-template pTemplate="output">
										{{cproduct.tnprice}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td class="text-right" [pEditableColumn]="cproduct.tntxable" pEditableColumnField="tntxable">
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="number" [(ngModel)]="cproduct.tntxable"
											(ngModelChange)="onChange($event, cproduct, 'namt')">
										
									</ng-template>
									<ng-template pTemplate="output">
										{{cproduct.tntxable}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td class="text-right" [pEditableColumn]="cproduct.tncgst" pEditableColumnField="tncgst">
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="number" [(ngModel)]="cproduct.tncgst"
											(ngModelChange)="onChange($event, cproduct, 'cgst')">
										
									</ng-template>
									<ng-template pTemplate="output">
										{{cproduct.tncgst}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td class="text-right">{{cproduct.tncamt}}</td>
							<td class="text-right" [pEditableColumn]="cproduct.tnsgst" pEditableColumnField="tnsgst">
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="number" [(ngModel)]="cproduct.tnsgst"
											(ngModelChange)="onChange($event, cproduct, 'sgst')">
										
									</ng-template>
									<ng-template pTemplate="output">
										{{cproduct.tnsgst}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td class="text-right">
								{{cproduct.tnsamt}}
							</td>
							<td class="text-right" [pEditableColumn]="cproduct.tntamt" pEditableColumnField="tntamt">
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="number" [(ngModel)]="cproduct.tntamt"
											(ngModelChange)="onChange($event, cproduct, 'tntamt')">
										
									</ng-template>
									<ng-template pTemplate="output">
										{{cproduct.tntamt}}
									</ng-template>
								</p-cellEditor>
							</td>
						</tr>
					</ng-template>
				</p-table>

            <!--Final Total & GST Summary-->
            <p-card header="Bill Summary">
                <div class="flex justify-content-between">
                    <div>
                        <table class="table">
                            <thead>
                                <th class="text-center">GST Type</th>
                                <th class="text-center">Net Amount</th>
                                <th class="text-center">Total CGST</th>
                                <th class="text-center">Total SGST</th>
                                <th class="text-center">Total Amount</th>
                            </thead>
                            <tbody>
                                <tr *ngFor="let gst of gstSummary| keyvalue">
                                    <td>{{gst.value.gngstp}}</td>
                                    <td class="text-right">{{gst.value.gntxable | number : '1.2-2'}}</td>
                                    <td class="text-right">{{gst.value.gncamt | number : '1.2-2'}}</td>
                                    <td class="text-right">{{gst.value.gnsamt | number : '1.2-2'}}</td>
                                    <td class="text-right">{{gst.value.gntamt | number : '1.2-2'}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div style="width: 200px;" class="mr-4">
                        <table class="table">
                            <tbody>
                                <tr>
                                    <td>Net Amount</td>
                                    <td class="text-right">{{billSummary.bsnamt | number : '1.2-2'}}</td>
                                </tr>
                                <tr>
                                    <td>Total CGST</td>
                                    <td class="text-right">{{billSummary.bstcgst | number : '1.2-2'}}</td>
                                </tr>
                                <tr>
                                    <td>Total SGST</td>
                                    <td class="text-right">{{billSummary.bstsgst | number : '1.2-2'}}</td>
                                </tr>
                                <tr>
                                    <td>Total Amount</td>
                                    <td class="text-right">{{billSummary.bstamt | number : '1.2-2'}}</td>
                                </tr>
                                <tr>
                                    <td>Rounded Off</td>
                                    <td class="text-right">{{billSummary.bsroff | number : '1.2-2'}}</td>
                                </tr>
                                <tr>
                                    <td>Final Amount</td>
                                    <td class="text-right">{{billSummary.bsfamt | number : '1.2-2'}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </p-card>
            <div class="flex justify-content-start mt-4">
                <p-button label="Download Bill" (click) = download()></p-button>
            </div>
        </p-fieldset>
    </div>
</p-card>